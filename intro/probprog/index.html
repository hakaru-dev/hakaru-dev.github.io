<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Hakaru Team">
        
        <link rel="shortcut icon" href="favicon.ico">
        

	<title>What is Probabilistic Programming? - Hakaru</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">
        <link href="../../logo.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">Hakaru</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Home</a>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Introduction <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li class="active">
    <a href="./">What is Probabilistic Programming?</a>
</li>

                    
                        
<li >
    <a href="../installation/">Installing Hakaru</a>
</li>

                    
                        
<li >
    <a href="../quickstart/">Quick Start</a>
</li>

                    
                        
<li >
    <a href="../../examples/">Examples</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Language Guide <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../lang/rand/">Random Primitives</a>
</li>

                    
                        
<li >
    <a href="../../lang/letbind/">Let and Bind</a>
</li>

                    
                        
<li >
    <a href="../../lang/cond/">Conditionals</a>
</li>

                    
                        
<li >
    <a href="../../lang/coercions/">Coercions</a>
</li>

                    
                        
<li >
    <a href="../../lang/functions/">Functions and Let</a>
</li>

                    
                        
<li >
    <a href="../../lang/datatypes/">Datatypes and match</a>
</li>

                    
                        
<li >
    <a href="../../lang/arrays/">Arrays</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Transformations <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../transforms/expect/">Expect</a>
</li>

                    
                        
<li >
    <a href="../../transforms/disintegrate/">Disintegrate</a>
</li>

                    
                        
<li >
    <a href="../../transforms/simplify/">Simplify</a>
</li>

                    
                        
<li >
    <a href="../../transforms/mh/">Metropolis Hastings</a>
</li>

                    
                        
<li >
    <a href="../../transforms/compile/">Compiling to Haskell</a>
</li>

                    
                        
<li >
    <a href="../../transforms/hkc/">Compiling to C</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Internals <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../internals/ast/">AST and Hakaru Datakind</a>
</li>

                    
                        
<li >
    <a href="../../internals/abt/">ABT</a>
</li>

                    
                        
<li >
    <a href="../../internals/datums/">Datums</a>
</li>

                    
                        
<li >
    <a href="../../internals/coercions/">Coercions</a>
</li>

                    
                        
<li >
    <a href="../../internals/transforms/">Transformaitons</a>
</li>

                    
                        
<li >
    <a href="../../internals/testing/">Testing</a>
</li>

                    
                        
<li >
    <a href="../../internals/newfeature/">Adding a Language Feature</a>
</li>

                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                <li >
                    <a rel="next" href="../..">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../installation/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/hakaru-dev/hakaru">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#what-is-probabilistic-programming">What is Probabilistic Programming?</a></li>
        
            <li><a href="#probabilistic-models">Probabilistic Models</a></li>
        
            <li><a href="#methods-of-probabilistic-reasoning">Methods of Probabilistic Reasoning</a></li>
        
            <li><a href="#example-bayesian-tug-of-war">Example: Bayesian Tug-of-War</a></li>
        
            <li><a href="#simulation-vs-inference">Simulation vs Inference</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="what-is-probabilistic-programming">What is Probabilistic Programming?</h1>
<p>Probablilistic programming is a software-driven method for creating probabilistic models and then using them to make probabilistic inferences. It 
provides a means for writing programs which describe probabilistic models such that they can be used to make probabilistic inferences. For example, the 
Hakaru program <script type="math/tex">poisson(5)</script> represents the Poisson distribution with a rate of five. A Probabilistic Programming Language (PPL) is a computer language designed to 
describe probabalistic models and distributions such that probabilistic inferences can be made programmatically<sup id="fnref:1"><a class="footnote-ref" href="#fn:1" rel="footnote">1</a></sup>. Hakaru is an example of a PPL. </p>
<p>Why do we need a programming language for describing probability distributions? Consider a machine learning problem. A typical workflow for this type of design is, when 
presented with a problem, to design an inference algorithm for a specific probabilistic distribution and query. The development of a distribution, query, and inference
algorithm can be a time consuming task, even for someone that is skilled in these areas. Automating this process via a PPL allows for a broader exploration of the design
space without the added effort that is required to using a traditional approach.</p>
<h2 id="probabilistic-models">Probabilistic Models</h2>
<p>The world is intrinsically an uncertain place. When you try to predict what will happen in the world given some data you have collected, you are engaging in some
sort of probabilistic modeling. A distribution or program that describes your data is called the <em>model</em>. In probabilistic modeling, the quantity you wish to predict is 
treated as a parameter and known data is described as some noisy function of this parameter. This function is called the <em>likelihood</em> of the parameter. </p>
<p>For example, you might want to estimate the average time it takes for a bus to arrive at a stop based on actual arrival times. In this situation, you determine that you
can represent the likelihood function using a Poisson distribution:</p>
<p>
<script type="math/tex; mode=display"> x \sim \text{Poisson}(\lambda) </script>
</p>
<p>where <script type="math/tex"> x </script> is the actual arrival time, and <script type="math/tex">\lambda</script> is the quantity you are using to make the prediction. </p>
<p>You can also represent this likelihood function as a density function which returns how likely it is for <script type="math/tex">x</script> to be generated for a given choice of <script type="math/tex">\lambda</script>:</p>
<p>
<script type="math/tex; mode=display"> f(\lambda) = \frac{\lambda^x e^{-\lambda}}{x!} </script>
</p>
<h2 id="methods-of-probabilistic-reasoning">Methods of Probabilistic Reasoning</h2>
<p>There are two main approaches to statistical reasoning: Frequentist and Bayesian. In Frequentist reasoning, the goal is to maximize the liklihood function. In the density
model for our bus arrival times, this would mean finding a value for <script type="math/tex">\lambda</script> that maximizes <script type="math/tex">f</script>. In Bayesian reasoning, an estimation is made using the given 
function parameters and a conditioned data set collected for the event. For our density model, we would design an estimation functions using our parameters and given it
our set of bus arrival times to predict a value for <script type="math/tex">f</script>. You can use either approach to probabilistic reasoning in your Hakaru programs. </p>
<h2 id="example-bayesian-tug-of-war">Example: Bayesian Tug-of-War</h2>
<p>To demonstrate the value of this problem-solving approach, we will write a Hakaru program to represent a simplified version of the 
<a href="https://probmods.org/v1/generative-models.html#example-bayesian-tug-of-war">tug-of-war</a> example from probmods.org.</p>
<p>Three friends, Alice, Bob and Carol, want to know which of them is the strongest. They decide that the winner of a game of tug-of-war must be stronger than their opponent,
and arrange to take turns playing tug-of-war against each other. The person who wins the most matches will be deemed the strongest of them.</p>
<p>You can write a probabilistic program to represent this scenario. In this simulation, the friends are only interested in knowing who will win the third match (<code>match3</code>) 
when they already know who won the first two matches. You can represent this problem using either the frequentist or Bayesian reasoning methods, but this example will use 
the Bayesian approach.</p>
<p>Your program will begin with the description of the probabilistic model. You can assume that each friend&rsquo;s strength comes from a standard normal distribution and that the 
strength that they pull with also follows some normal distribution centered around their true strength. You can also trivially assume that the friend that pulled the 
hardest will win the match. You can represent this model in Hakaru by writing:</p>
<pre><code class="nohighlight">def pulls(strength real):
    normal(strength, 1)

def winner(a real, b real):
    a_pull &lt;~ pulls(a)
    b_pull &lt;~ pulls(b)
    return (a_pull &gt; b_pull)

alice &lt;~ normal(0,1)
bob   &lt;~ normal(0,1)
carol &lt;~ normal(0,1)

match1 &lt;~ winner(alice, bob)
match2 &lt;~ winner(bob, carol)
match3 &lt;~ winner(alice, carol)
</code></pre>

<p><strong>Note:</strong> This Hakaru code will not compile yet.</p>
<p>Now that you have created your model, you can create inference rules based on known data. In the third match, Alice is competing against Carol. She wants to know how 
likely she is to win the match. She won her match against Bob (<code>match1</code>) and that Carol lost her match to Bob (<code>match2</code>). </p>
<p>In your model, the result of <code>match1</code> is <code>True</code> when Alice wins and the result of <code>match2</code> is <code>True</code> when Carol loses. You can use this knowledge to write an inference
rule for your scenario that will return the result of <code>match3</code> when Alice wins <code>match1</code> and Carol loses <code>match2</code>. If a simulation is run that does not match this pattern,
it is rejected. This inference rule can be written in Hakaru as:</p>
<pre><code class="nohighlight">if match1 &amp;&amp; match2:
   return match3
else:
   reject. measure(bool)
</code></pre>

<p>You have now created a Hakaru program that describes a probabilistic model and an inference rule based on known data. You should save your program as <code>tugofwar.hk</code> so that
you can run Hakaru to infer the outcome of <code>match3</code>. </p>
<p>If you call <code>hakaru tugofwar.hk</code>, you will get a continuous stream of Boolean results. You can make the calculations more legible by restricting the number of program 
executions and counting how many of each Boolean appears. For example, if you restrict the number of program executions to 10000 and collect the results, you will see that 
<code>True</code> occurs much more frequently than <code>False</code>. This means that Alice is likely to win <code>match3</code> against Carol.</p>
<pre><code class="bash">hakaru tugofwar.hk | head -n 10000 | sort | uniq -c
   3060 false
   6940 true
</code></pre>

<h2 id="simulation-vs-inference">Simulation vs Inference</h2>
<p>Of course, in the above program we performed inference, by taking our model and throwing out all events that didn&rsquo;t agree with the data we had. How well would this work if 
we changed our model slightly? Suppose our data wasn&rsquo;t boolean values, but instead the difference of strengths, and we want to not just whether Alice will win, but by how 
much.</p>
<p>As we pose more complex questions, posing our models as rejection samplers becomes increasing inefficient. Instead we would like to directly transform our models into those 
which only generate the data we observed and don&rsquo;t waste any computation simulating data which we know will never exist.</p>
<h3 id="metropolis-hastings">Metropolis Hastings</h3>
<p>By default hakaru performs importance sampling. This works well for inference in low dimensions, but we want to use MCMC for more realistic problems. Hakaru provides a <code>mh</code> 
command tool to transform probabilistic programs into a Markov Chain.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p><a href="https://en.wikipedia.org/wiki/Probabilistic_programming_language">Proababilistic programming language (Wikipedia)</a>&#160;<a class="footnote-backref" href="#fnref:1" rev="footnote" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script>
        <script src="../../js/mathjaxhelper.js"></script>
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>